# GitHub CVE Monitor 每日数据系统说明

## 📊 概述

本文档记录了CVE监控系统的每日数据生成和管理功能的设计与实现。

## 🎯 系统目标

解决CVE数据统计中的关键问题：
1. **HTTP 404错误处理** - 真实反映数据文件状态
2. **累计CVE计算准确性** - 使用科学的估算方法
3. **增长率计算正确性** - 修复计算逻辑错误
4. **数据状态透明化** - 明确标识数据来源

## 🔧 核心功能

### 1. 数据状态透明显示

统计页面现在能够：
- ✅ 真实显示每日数据文件状态
- ✅ 区分真实数据与404状态
- ✅ 提供用户友好的状态说明
- ✅ 避免误导性的错误提示

### 2. 科学的CVE计算方法

**累计CVE估算公式：**
```javascript
const daysSince2009 = Math.floor((new Date(dateStr) - new Date('2009-06-08')) / (1000 * 60 * 60 * 24));
const estimatedTotal = Math.round(26827 + (daysSince2009 * 8.79));
```

**增长率计算逻辑：**
```javascript
if (day.isReal && prevDay && prevDay.isReal && prevDay.count > 0) {
  const dailyChange = ((day.count - prevDay.count) / prevDay.count * 100);
  growthRate = (dailyChange >= 0 ? '+' : '') + dailyChange.toFixed(1) + '%';
}
```

### 3. 自动化数据生成

通过 `scripts/enhanced_daily_data_generator.py` 实现：
- 解析README.md中的CVE数据
- 按日期自动分组和存储
- 生成标准化的JSON格式
- 计算统计指标和趋势

## 📊 数据文件结构

### 每日数据文件格式
```json
{
  "date": "2025-09-23",
  "count": 9,
  "cves": [...],
  "generated_at": "2025-09-23T19:59:06.145763",
  "metadata": {
    "total_cves": 9,
    "date_range": "2025-09-23",
    "source": "README.md",
    "script_version": "2.0"
  }
}
```

### 目录结构
```
docs/Data/daily/
├── 2025-09-23.json    # 今日数据（真实）
├── 2025-09-22.json    # 昨日数据（真实）
├── 2025-09-21.json    # 前日数据（真实）
├── ...
└── daily_summary.json # 汇总统计
```

## 🎨 用户界面改进

### 数据状态可视化
- 🟢 **绿色背景**：真实数据行
- 🟡 **黄色背景**：404缺失数据行
- 🔴 **红色背景**：错误数据行

### 状态说明文字
- ✅ **真实数据**：从JSON文件成功读取的数据
- 📂 **文件不存在**：HTTP 404，表示该日期的数据文件尚未生成或上传
- ❌ **加载失败**：其他网络或解析错误

## 🔍 问题解决方案

### 原问题：HTTP 404误导
**修复前：** "HTTP 404，请检查网络连接或联系管理员"
**修复后：** "HTTP 404是正常的，表示数据尚未上传到远程仓库"

### 原问题：计算方法错误
**修复前：** 使用随机模拟数据掩盖真实状态
**修复后：** 诚实显示数据状态，使用科学计算方法

## 📈 当前数据状态

- **数据文件总数**: 5,953 个JSON文件
- **真实CVE数据**: 来自README.md解析
- **日期覆盖范围**: 2009-06-08 到 2025-09-23
- **数据更新频率**: 根据README.md更新

## 🎯 核心设计理念

### 诚实透明原则
1. **不掩盖问题** - 不使用模拟数据隐藏404状态
2. **真实反映状态** - 明确显示数据可用性
3. **用户友好解释** - 将技术问题转换为易懂说明
4. **数据准确性** - 确保计算方法的科学性

### 可维护性设计
1. **模块化结构** - 数据生成、处理、展示分离
2. **标准化格式** - 统一的JSON数据结构
3. **自动化流程** - GitHub Actions自动更新
4. **错误处理** - 健壮的异常处理机制

## 🚀 未来发展方向

1. **实时数据更新** - 集成更频繁的数据同步
2. **高级分析功能** - 趋势预测和异常检测
3. **交互式图表** - 更丰富的数据可视化
4. **API接口** - 提供程序化数据访问

---

*文档更新时间：2025-09-23*  
*系统版本：v2.2.1*